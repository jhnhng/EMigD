<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="EMigD">
<title>Using the functions in `EMigD` • EMigD</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Using the functions in `EMigD`">
<meta property="og:description" content="EMigD">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">EMigD</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.2.500</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/01%20Setting%20Up%20the%20Data.html">Setting Up the Data</a>
    <a class="dropdown-item" href="../articles/02%20Different%20intervals%20between%20seasons.html">Different intervals between seasons</a>
    <a class="dropdown-item" href="../articles/03%20Using-EmigD.html">Using the functions in `EMigD`</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Using the functions in `EMigD`</h1>
            
      
      
      <div class="d-none name"><code>03 Using-EmigD.Rmd</code></div>
    </div>

    
    
<pre><code><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://jhnhng.github.io/EMigD/">EMigD</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org" class="external-link">lubridate</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></code></pre>
<div class="section level2">
<h2 id="earth-movers-distance">Earth Mover’s Distance<a class="anchor" aria-label="anchor" href="#earth-movers-distance"></a>
</h2>
<p>The earth mover’s distance (EMD), also known as the Wasserstein
metric, is a measure of the distance between two probability
distributions over a region. For example, if the distributions are two
different ways of piling up a certain amount of dirt over a region, the
EMD is the minimum effort needed in turning one pile into the other,
where the cost is assumed to be the amount of dirt moved times the
distance it is moved.</p>
</div>
<div class="section level2">
<h2 id="emds">EMDs<a class="anchor" aria-label="anchor" href="#emds"></a>
</h2>
<p>Calculates the EMD’s between the summer and winter UDs. In our
example, <code>seasons[[1]]</code> and <code>seasons[[2]]</code> are
used to calculate the EMDs in geographical space, while
<code>sum_rst</code> and <code>win_rst</code> are used to calculate the
EMDs in environmental space.</p>
<pre><code><span class="co"># Geographical Space</span>
<span class="va">btwemd_geo</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/between_emd.html">between_emd</a></span><span class="op">(</span><span class="va">sum_raster</span>, <span class="va">win_raster</span><span class="op">)</span>

<span class="co"># Environmental Space</span>
<span class="va">btwemd_env</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/between_emd.html">between_emd</a></span><span class="op">(</span><span class="va">sum_rst</span>, <span class="va">win_rst</span><span class="op">)</span></code></pre>
<p>Calculates the EMDs between the intervals within a single season.</p>
<pre><code><span class="co"># Geographical Space</span>
<span class="va">withsum_geo</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/within_emd.html">within_emd</a></span><span class="op">(</span><span class="va">sum_raster</span><span class="op">)</span>
<span class="va">withwin_geo</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/within_emd.html">within_emd</a></span><span class="op">(</span><span class="va">win_raster</span><span class="op">)</span>

<span class="co"># Environmental Space</span>
<span class="va">withsum_env</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/within_emd.html">within_emd</a></span><span class="op">(</span><span class="va">sum_rst</span><span class="op">)</span>
<span class="va">withwin_env</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/within_emd.html">within_emd</a></span><span class="op">(</span><span class="va">win_rst</span><span class="op">)</span></code></pre>
</div>
<div class="section level2">
<h2 id="em-speeds">EM-Speeds<a class="anchor" aria-label="anchor" href="#em-speeds"></a>
</h2>
<p>Calculate ‘EM-speeds’ by dividing each EMD by the time elapsed
between the two UDs it corresponds to. For example, to calculate the
EM-speeds between the first intervals in <code>jan</code> and
<code>july</code>, the EMDs for the intervals are divided by the the
difference in Julian dates between the starts dates of each
interval.</p>
<p>$EMD /(Julian.start.2 - Julian.start.1) $</p>
<p>We calculated the EM-speeds between seasons (e.g., first intervals
between <code>jan</code> and <code>july</code>), and within seasons
(e.g., first and second intervals between <code>jan</code> and
<code>july</code>) using the <code><a href="../reference/emspeeds.html">emspeeds()</a></code> in our
<code>EMigD</code> package. The example below demonstrates the
calculation for the EM-speeds for geographical space, but can easily be
replaced with <code>btwemd_env</code>, <code>withsum_env</code> and
<code>withwin_env</code>.</p>
<pre><code><span class="va">btwesp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/emspeeds.html">emspeeds</a></span><span class="op">(</span><span class="va">july</span>, <span class="va">jan</span>, <span class="va">btwemd_geo</span><span class="op">)</span>

<span class="va">wesp_sum</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/emspeeds.html">emspeeds</a></span><span class="op">(</span><span class="va">july</span>, <span class="va">july</span>, <span class="va">withsum_geo</span><span class="op">)</span>
<span class="va">wesp_win</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/emspeeds.html">emspeeds</a></span><span class="op">(</span><span class="va">jan</span>, <span class="va">jan</span>, <span class="va">withwin_geo</span><span class="op">)</span></code></pre>
</div>
<div class="section level2">
<h2 id="average-within-and-between-season-em-speeds">Average Within and Between Season EM-Speeds<a class="anchor" aria-label="anchor" href="#average-within-and-between-season-em-speeds"></a>
</h2>
<p>We calculated the average between-season and within-season EM-speeds,
where each unique value is counted only once and any zeros are excluded.
If an animal does not shift its space use between season, the
within-season EM-speeds should be similar to the between-seasons
EM-speeds.</p>
<pre><code><span class="va">btwavg_geo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">btwesp</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">x</span><span class="op">!=</span> <span class="fl">0</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="va">wesp_both</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Map</a></span><span class="op">(</span><span class="va">c</span>, <span class="va">wesp_sum</span>, <span class="va">wesp_win</span><span class="op">)</span>
<span class="va">wesavg_geo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">wesp_all</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">x</span><span class="op">!=</span> <span class="fl">0</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre>
<p>The ratio between the two averages are the migratory predictors and
are limitless. Values that are closer to 0 may indicate that an
individual did not migrate during a given year, while values further
from 0 may indicate that an individual has migrated.</p>
<pre><code><span class="va">predictor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Map</a></span><span class="op">(</span><span class="st">"/"</span>, <span class="va">btwavg_geo</span>, <span class="va">wavg_geo</span><span class="op">)</span></code></pre>
<p>The results can then be extracted and placed into a data frame which
can then be written into a .csv file or your preferred file type.</p>
<pre><code><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span>text <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">win_raster</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, header <span class="op">=</span> <span class="cn">FALSE</span>, 
                            col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ID"</span>, <span class="st">"Year"</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span>,
                 geo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">predictor</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">out</span>, file<span class="op">=</span><span class="st">"Data/Results.csv"</span><span class="op">)</span></code></pre>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by John Huang.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a>
2.0.2.9000.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
